nohup: ignoring input
Begin Process:
command line args:  {"arch_sparse_feature_size": 16, "arch_embedding_size": "4-3-2", "arch_mlp_bot": "13-512-256-64-16", "arch_mlp_top": "512-256-1", "arch_interaction_op": "dot", "arch_interaction_itself": false, "md_flag": false, "md_threshold": 200, "md_temperature": 0.3, "md_round_dims": false, "qr_flag": false, "qr_threshold": 200, "qr_operation": "mult", "qr_collisions": 4, "activation_function": "relu", "loss_function": "bce", "loss_weights": "1.0-1.0", "loss_threshold": 0.0, "round_targets": true, "data_size": 1, "num_batches": 0, "data_generation": "dataset", "data_trace_file": "./input/dist_emb_j.log", "data_set": "kaggle", "raw_data_file": "/mnt/DP_disk1/dlrm/kaggle/backup/train.txt", "processed_data_file": "/mnt/DP_disk1/dlrm/kaggle/backup/kaggleAdDisplayChallenge_processed.npz", "data_randomize": "total", "data_trace_enable_padding": false, "max_ind_range": -1, "data_sub_sample_rate": 0.0, "num_indices_per_lookup": 10, "num_indices_per_lookup_fixed": false, "num_workers": 0, "memory_map": false, "mini_batch_size": 128, "nepochs": 1, "learning_rate": 0.1, "print_precision": 5, "numpy_rand_seed": 123, "sync_dense_params": true, "inference_only": false, "save_onnx": false, "use_gpu": false, "print_freq": 1000, "test_freq": 5000, "test_mini_batch_size": 128, "test_num_workers": 16, "print_time": true, "debug_mode": false, "enable_profiling": false, "plot_compute_graph": false, "save_model": "", "load_model": "", "mlperf_logging": true, "mlperf_acc_threshold": 0.0, "mlperf_auc_threshold": 0.8025, "mlperf_bin_loader": true, "mlperf_bin_shuffle": false, "lr_num_warmup_steps": 0, "lr_decay_start_step": 0, "lr_num_decay_steps": 0}
Using CPU...
Begin data pre-processing
Reading pre-processed data=/mnt/DP_disk1/dlrm/kaggle/backup/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/mnt/DP_disk1/dlrm/kaggle/backup/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
Begin commandline parse
Begin Mainloop
time/loss/accuracy (if enabled):
Finished training it 1000/306969 of epoch 0, 17.67 ms/it, loss 0.518421, accuracy 75.590 %
Finished training it 2000/306969 of epoch 0, 17.08 ms/it, loss 0.505513, accuracy 76.284 %
Finished training it 3000/306969 of epoch 0, 13.31 ms/it, loss 0.497847, accuracy 76.562 %
Finished training it 4000/306969 of epoch 0, 13.14 ms/it, loss 0.488338, accuracy 77.345 %
Finished training it 5000/306969 of epoch 0, 13.14 ms/it, loss 0.486406, accuracy 77.268 %
train 5000 iteration time:76.44762110710144
Testing at - 5000/306969 of epoch 0, loss 0.489094, recall 0.2208, precision 0.6777, f1 0.3330, ap 0.5440, auc 0.7616, best auc 0.7616, accuracy 76.890 %, best accuracy 76.890 %
test consuming time:177.47780752182007
Finished training it 6000/306969 of epoch 0, 15.76 ms/it, loss 0.482105, accuracy 77.456 %
Finished training it 7000/306969 of epoch 0, 15.13 ms/it, loss 0.478117, accuracy 77.735 %
Finished training it 8000/306969 of epoch 0, 13.48 ms/it, loss 0.477229, accuracy 77.771 %
Finished training it 9000/306969 of epoch 0, 13.30 ms/it, loss 0.474092, accuracy 77.945 %
Finished training it 10000/306969 of epoch 0, 13.25 ms/it, loss 0.471346, accuracy 77.951 %
train 5000 iteration time:324.8661775588989
